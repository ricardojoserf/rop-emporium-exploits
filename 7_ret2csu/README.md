# ret2csu

Link: https://ropemporium.com/challenge/ret2csu.html

Goal: *Call the ret2win() function, the caveat this time is that the third argument (which you know by now is stored in the rdx register on x86_64 Linux) must be 0xdeadcafebabebeef*

-----------------------


We will read some blogs about ret2csu:

- https://i.blackhat.com/briefings/asia/2018/asia-18-Marco-return-to-csu-a-new-method-to-bypass-the-64-bit-Linux-ASLR-wp.pdf

- https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/medium-rop/

- https://bananamafia.dev/post/x64-rop-redpwn/


## 0. Studying the binary

First, we check with GDB that the offset is still 40. It seems so given that with 41 characters we see only one "41" in RIP registry::

![a](images/Screenshot_1.jpg)

Then we see the address of *ret2win()* is 0x4007b1:

![a](images/Screenshot_2.jpg)

We will also check the GCC version used for compiling it, it may be important from the description of the challenge:

![a](images/Screenshot_2.jpg)

## 1. 

From the "callme" challenge we know that the arguments are pushed to the stack in the 32 bits architecture and stored in registers in the 64 bits one ([source](https://uclibc.org/docs/psABI-x86_64.pdf)):

- First Argument: RDI

- Second Argument: RSI

- Third Argument: RDX

